!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=6)}([function(t,e){t.exports=Cesium},function(t,e){t.exports=function(){try{return echarts}catch(t){return{}}}()},function(t,e){t.exports=function(){try{return mapv}catch(t){return{}}}()},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var n,s,o;s=[e,t],void 0===(o="function"==typeof(n=function(t,e){"use strict";var i={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function n(t){try{delete window[t]}catch(e){window[t]=void 0}}function s(t){var e=document.getElementById(t);e&&document.getElementsByTagName("head")[0].removeChild(e)}e.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=t,r=e.timeout||i.timeout,a=e.jsonpCallback||i.jsonpCallback,c=void 0;return new Promise(function(i,h){var u=e.jsonpCallbackFunction||"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),l=a+"_"+u;window[u]=function(t){i({ok:!0,json:function(){return Promise.resolve(t)}}),c&&clearTimeout(c),s(l),n(u)},o+=-1===o.indexOf("?")?"?":"&";var p=document.createElement("script");p.setAttribute("src",""+o+a+"="+u),e.charset&&p.setAttribute("charset",e.charset),p.id=l,document.getElementsByTagName("head")[0].appendChild(p),c=setTimeout(function(){h(new Error("JSONP request to "+t+" timed out")),n(u),s(l),window[u]=function(){n(u)}},r),p.onerror=function(){h(new Error("JSONP request to "+t+" failed")),n(u),s(l),c&&clearTimeout(c)}})}})?n.apply(e,s):n)||(t.exports=o)},function(t,e,i){"use strict";(function(e){var i=setTimeout;function n(){}function s(t){if(!(this instanceof s))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],h(t,this)}function o(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,s._immediateFn(function(){var i=1===t._state?e.onFulfilled:e.onRejected;if(null!==i){var n;try{n=i(t._value)}catch(t){return void a(e.promise,t)}r(e.promise,n)}else(1===t._state?r:a)(e.promise,t._value)})):t._deferreds.push(e)}function r(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var i=e.then;if(e instanceof s)return t._state=3,t._value=e,void c(t);if("function"==typeof i)return void h((n=i,o=e,function(){n.apply(o,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(e){a(t,e)}var n,o}function a(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&s._immediateFn(function(){t._handled||s._unhandledRejectionFn(t._value)});for(var e=0,i=t._deferreds.length;e<i;e++)o(t,t._deferreds[e]);t._deferreds=null}function h(t,e){var i=!1;try{t(function(t){i||(i=!0,r(e,t))},function(t){i||(i=!0,a(e,t))})}catch(t){if(i)return;i=!0,a(e,t)}}s.prototype.catch=function(t){return this.then(null,t)},s.prototype.then=function(t,e){var i=new this.constructor(n);return o(this,new function(t,e,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=i}(t,e,i)),i},s.prototype.finally=function(t){var e=this.constructor;return this.then(function(i){return e.resolve(t()).then(function(){return i})},function(i){return e.resolve(t()).then(function(){return e.reject(i)})})},s.all=function(t){return new s(function(e,i){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var n=Array.prototype.slice.call(t);if(0===n.length)return e([]);var s=n.length;function o(t,r){try{if(r&&("object"==typeof r||"function"==typeof r)){var a=r.then;if("function"==typeof a)return void a.call(r,function(e){o(t,e)},i)}n[t]=r,0==--s&&e(n)}catch(t){i(t)}}for(var r=0;r<n.length;r++)o(r,n[r])})},s.resolve=function(t){return t&&"object"==typeof t&&t.constructor===s?t:new s(function(e){e(t)})},s.reject=function(t){return new s(function(e,i){i(t)})},s.race=function(t){return new s(function(e,i){for(var n=0,s=t.length;n<s;n++)t[n].then(e,i)})},s._immediateFn="function"==typeof e&&function(t){e(t)}||function(t){i(t,0)},s._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},t.exports=s}).call(this,i(10).setImmediate)},function(t,e,i){"use strict";i.r(e),window.CesiumZondy=window.CesiumZondy||{};var n=window.CesiumZondy||{};n.GeoSpark=n.GeoSpark||{},n.ElasticSearch=n.ElasticSearch||{},n.Overlayer=n.Overlayer||{};var s=i(2),o=i(0),r=i.n(o),a=s.baiduMapLayer?s.baiduMapLayer.__proto__:Function;class c extends a{constructor(t,e,i,n){if(super(t,e,i),a){this.map=t,this.scene=t.scene,this.dataSet=e;i=i||{},this.init(i),this.argCheck(i),this.initDevicePixelRatio(),this.canvasLayer=n,this.stopAniamation=!1,this.animation=i.animation,this.clickEvent=this.clickEvent.bind(this),this.mousemoveEvent=this.mousemoveEvent.bind(this),this.bindEvent()}}initDevicePixelRatio(){this.devicePixelRatio=window.devicePixelRatio||1}clickEvent(t){var e=t.point;super.clickEvent(e,t)}mousemoveEvent(t){var e=t.point;super.mousemoveEvent(e,t)}addAnimatorEvent(){}animatorMovestartEvent(){var t=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=t.stepsRange.start)}animatorMoveendEvent(){this.isEnabledTime()&&this.animator}bindEvent(){this.map;this.options.methods&&(this.options.methods.click,this.options.methods.mousemove)}unbindEvent(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.off("click",this.clickEvent),this.options.methods.mousemove&&t.off("mousemove",this.mousemoveEvent))}getContext(){return this.canvasLayer.canvas.getContext(this.context)}init(t){this.options=t,this.initDataRange(t),this.context=this.options.context||"2d",this.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(this.options.zIndex),this.initAnimator()}_canvasUpdate(t){this.map;var e=this.scene;if(this.canvasLayer&&!this.stopAniamation){var i=this.options.animation,n=this.getContext();if(this.isEnabledTime()){if(void 0===t)return void this.clear(n);"2d"===this.context&&(n.save(),n.globalCompositeOperation="destination-out",n.fillStyle="rgba(0, 0, 0, .1)",n.fillRect(0,0,n.canvas.width,n.canvas.height),n.restore())}else this.clear(n);if("2d"===this.context)for(var o in this.options)n[o]=this.options[o];else n.clear(n.COLOR_BUFFER_BIT);var a={transferCoordinate:function(t){var i=r.a.Cartesian3.fromDegrees(t[0],t[1]),n=r.a.SceneTransforms.wgs84ToWindowCoordinates(e,i);return void 0==n?[-1,-1]:[n.x,n.y]}};void 0!==t&&(a.filter=function(e){var n=i.trails||10;return!!(t&&e.time>t-n&&e.time<t)});var c=this.dataSet.get(a);this.processData(c),"m"==this.options.unit&&this.options.size,this.options._size=this.options.size;var h=r.a.SceneTransforms.wgs84ToWindowCoordinates(e,r.a.Cartesian3.fromDegrees(0,0));this.drawContext(n,new s.DataSet(c),this.options,h),this.options.updateCallback&&this.options.updateCallback(t)}}updateData(t,e){var i=t;i&&i.get&&(i=i.get()),void 0!=i&&this.dataSet.set(i),super.update({options:e})}addData(t,e){var i=t;t&&t.get&&(i=t.get()),this.dataSet.add(i),this.update({options:e})}getData(){return this.dataSet}removeData(t){if(this.dataSet){var e=this.dataSet.get({filter:function(e){return null==t||"function"!=typeof t||!t(e)}});this.dataSet.set(e),this.update({options:null})}}clearData(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}draw(){this.canvasLayer.draw()}clear(t){t&&t.clearRect&&t.clearRect(0,0,t.canvas.width,t.canvas.height)}}var h=0;class u{constructor(t,e,i,n){this.map=t,this.scene=t.scene,this.mapvBaseLayer=new c(t,e,i,this),this.mapVOptions=i,this.initDevicePixelRatio(),this.canvas=this._createCanvas(),this.render=this.render.bind(this),void 0!=n?(this.container=n,n.appendChild(this.canvas)):(this.container=t.container,this.addInnerContainer()),this.bindEvent(),this._reset()}initDevicePixelRatio(){this.devicePixelRatio=window.devicePixelRatio||1}addInnerContainer(){this.container.appendChild(this.canvas)}bindEvent(){this.map;this.innerMoveStart=this.moveStartEvent.bind(this),this.innerMoveEnd=this.moveEndEvent.bind(this),this.innnerZoomStart=this.zoomStartEvent.bind(this),this.innnerZoomEnd=this.zoomEndEvent.bind(this);var t=new r.a.ScreenSpaceEventHandler(this.scene.canvas);t.setInputAction(this.innerMoveEnd,r.a.ScreenSpaceEventType.WHEEL),t.setInputAction(this.innerMoveStart,r.a.ScreenSpaceEventType.LEFT_DOWN),t.setInputAction(this.innerMoveEnd,r.a.ScreenSpaceEventType.LEFT_UP),t.setInputAction(this.innerMoveStart,r.a.ScreenSpaceEventType.RIGHT_DOWN),t.setInputAction(this.innerMoveEnd,r.a.ScreenSpaceEventType.RIGHT_UP)}unbindEvent(){this.map}moveStartEvent(){this.mapvBaseLayer&&this.mapvBaseLayer.animatorMovestartEvent(),this._unvisiable()}moveEndEvent(){this.mapvBaseLayer&&this.mapvBaseLayer.animatorMoveendEvent(),this._reset(),this._visiable()}zoomStartEvent(){this._unvisiable()}zoomEndEvent(){this._unvisiable()}addData(t,e){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer.addData(t,e)}updateData(t,e){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer.updateData(t,e)}getData(){return this.mapvBaseLayer&&(this.dataSet=this.mapvBaseLayer.getData()),this.dataSet}removeData(t){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer&&this.mapvBaseLayer.removeData(t)}removeAllData(){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer.clearData()}_visiable(){return this.canvas.style.display="block",this}_unvisiable(){return this.canvas.style.display="none",this}_createCanvas(){var t=document.createElement("canvas");t.id=this.mapVOptions.layerid||"mapv"+h++,t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=this.mapVOptions.zIndex||100,t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height;var e=this.devicePixelRatio;return"2d"==this.mapVOptions.context&&t.getContext(this.mapVOptions.context).scale(e,e),t}_reset(){this.resizeCanvas(),this.fixPosition(),this.onResize(),this.render()}draw(){this._reset()}show(){this._visiable()}hide(){this._unvisiable()}destroy(){this.remove()}remove(){void 0!=this.mapvBaseLayer&&(this.removeAllData(),this.mapvBaseLayer.clear(this.mapvBaseLayer.getContext()),this.mapvBaseLayer=void 0,this.canvas.parentElement.removeChild(this.canvas))}update(t){void 0!=t&&this.updateData(t.data,t.options)}resizeCanvas(){if(void 0!=this.canvas&&null!=this.canvas){var t=this.canvas;t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height}}fixPosition(){}onResize(){}render(){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer._canvasUpdate()}}n.Overlayer.MapvLayer=u;var l=i(1),p=i.n(l);function d(t,e){this._CesiumMap=t,this._CesiumScene=t.scene,this.dimensions=["lng","lat"],this._mapOffset=[0,0],this._mapViewRect,this._api=e}d.prototype.dimensions=["lng","lat"],d.prototype.setMapOffset=function(t){this._mapOffset=t},d.prototype.getBMap=function(){return this._CesiumMap},d.prototype.dataToPoint=function(t){var e=r.a.Cartesian3.fromDegrees(t[0],t[1]),i=this._CesiumMap.camera.position,n=this._CesiumMap.scene.globe.ellipsoid.cartesianToCartographic(i).height;if(n+=1.2*this._CesiumMap.scene.globe.ellipsoid.maximumRadius,r.a.Cartesian3.distance(i,e)>n)return[-50,-50];var s=this._mapOffset,o=(i=r.a.Cartesian3.fromDegrees(t[0],t[1]),r.a.SceneTransforms.wgs84ToWindowCoordinates(this._CesiumScene,i));return[o.x-s[0],o.y-s[1]]},d.prototype.pointToData=function(t){var e=this._mapOffset,i=r.a.Cartesian3.fromDegrees(t[0]+e[0],t[1]+e[1]),n=r.a.SceneTransforms.wgs84ToWindowCoordinates(this._CesiumScene,i);return[n.x,n.y]},d.prototype.getViewRect=function(){var t=this._api;return new p.a.graphic.BoundingRect(0,0,t.getWidth(),t.getHeight())},d.prototype.getRoamTransform=function(){return p.a.matrix.create()},d.prototype.prepareCustoms=function(t){var e=p.a.util,i=this.getViewRect();return{coordSys:{type:"cesium",x:i.x,y:i.y,width:i.width,height:i.height},api:{coord:e.bind(this.dataToPoint,this),size:e.bind(function(t,i){return i=i||[0,0],e.map([0,1],function(e){var n=i[e],s=t[e]/2,o=[],r=[];return o[e]=n-s,r[e]=n+s,o[1-e]=r[1-e]=i[1-e],Math.abs(this.dataToPoint(o)[e]-this.dataToPoint(r)[e])},this)},this)}}},d.dimensions=d.prototype.dimensions,d.create=function(t,e){var i;t.eachComponent("cesium",function(t){e.getZr().painter.getViewportRoot();var n=p.a.cesiumMap;(i=new d(n,e)).setMapOffset(t.__mapOffset||[0,0]),t.coordinateSystem=i}),t.eachSeries(function(t){"cesium"===t.get("coordinateSystem")&&(t.coordinateSystem=i)})};var f=0;class m{constructor(t,e,i){return this.map=t,this.scene=t.scene,this.options=e,this.initStats=!1,this.layerId=e.layerId||"echarts"+f++,this.layerClass=e.layerClass||"echartlayerdefaultclass",this.initDevicePixelRatio(),this.canvas=this._createCanvas(),this.container=t.container,this.addInnerContainer(),this.chart=p.a.init(this.canvas),this.initEcharts(),this._resizeCanvas(),this.resize(),this}initDevicePixelRatio(){this.devicePixelRatio=window.devicePixelRatio||1}addInnerContainer(){this.container.appendChild(this.canvas)}initEcharts(){return p.a.cesiumMap=this.map,p.a.registerCoordinateSystem("cesium",d),p.a.extendComponentModel({type:"cesium",getBMap:function(){return this.__cesium},defaultOption:{roam:!1}}),p.a.registerAction({type:"CesiumRoma",event:"CesiumRoma",update:"updateLayout"},function(t,e){}),this}_createCanvas(){var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=this.options.zIndex||100;var e=parseInt(this.map.canvas.width)+"px",i=parseInt(this.map.canvas.height)+"px";return t.width=e,t.height=i,t.style.width=e,t.style.height=i,t}_resizeCanvas(){const t=this;window.onresize=function(){var e=t.canvas,i=t.map;e.style.position="absolute",e.style.top="0px",e.style.left="0px";var n=parseInt(i.canvas.width)+"px",s=parseInt(i.canvas.height)+"px";e.width=n,e.height=s,e.style.width=n,e.style.height=s,t.chart.resize()}}_visible(){this.canvas.style.visibility="visible"}_unvisible(){this.canvas.style.visibility="hidden"}addTo(t){var e=this;return p.a.extendComponentView({type:"cesium",render:function(t,i,n){var s=!0,o=(p.a.cesiumMap,n.getZr().painter.getViewportRoot()),a=t.coordinateSystem,c=function(i,r){if(!s){e._unvisible();var c=e.map.canvas,h=[-parseInt(c.style.left,10)||0,-parseInt(c.style.top,10)||0];o.style.left=h[0]+"px",o.style.top=h[1]+"px",a.setMapOffset(h),t.__mapOffset=h,n.dispatchAction({type:"CesiumRoma"})}},h=function(i,r){if(!s){var c=e.map.canvas,h=[-parseInt(c.style.left,10)||0,-parseInt(c.style.top,10)||0];o.style.left=h[0]+"px",o.style.top=h[1]+"px",a.setMapOffset(h),t.__mapOffset=h,n.dispatchAction({type:"CesiumRoma"}),e._visible()}};var u=new r.a.ScreenSpaceEventHandler(e.scene.canvas);0==e.initStats&&(e.initStats=!0,u.setInputAction(function(){e._unvisible(),s||n.dispatchAction({type:"CesiumRoma"})},r.a.ScreenSpaceEventType.WHEEL),u.setInputAction(c,r.a.ScreenSpaceEventType.LEFT_DOWN),u.setInputAction(h,r.a.ScreenSpaceEventType.LEFT_UP),u.setInputAction(c,r.a.ScreenSpaceEventType.RIGHT_DOWN),u.setInputAction(h,r.a.ScreenSpaceEventType.RIGHT_UP)),this._oldMoveHandler=c,this._oldZoomEndHandler=function(){s||n.dispatchAction({type:"CesiumRoma"})};t.get("roam");s=!1}}),this.chart.setOption(this.options),this}show(){this._visible()}hide(){this._unvisible()}resize(){if(void 0!=this.canvas&&null!=this.canvas){var t=this.canvas;t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height}}remove(){return this.chart.clear(),this.canvas.parentElement&&this.canvas.parentElement.removeChild(this.canvas),this.map=void 0,this}}n.Overlayer.EchartsLayer=m;var v=window.Zondy=window.Zondy||{};v.Util=v.Util||{},v.Network=v.Network||{},v.GeoSpark=v.GeoSpark||{};const y="http://",w=":",g="pgsql/tableInfoAsJson?";var b=i(5),E=i.n(b);window.Promise=E.a;i(7);var _=i(4),T=i.n(_);v.Util=v.Util||{};v.Util.extend=function(t,e){if(t=t||{},e){for(var i in e){var n=e[i];void 0!==n&&(t[i]=n)}!("function"==typeof window.Event&&e instanceof window.Event)&&e.hasOwnProperty&&e.hasOwnProperty("toString")&&(t.toString=e.toString)}return t};var S=function(t,e){var i=t;if(e){var n=(t+" ").split(/[?&]/);i+=" "===n.pop()?e:n.length?"&"+e:"?"+e}return i};v.Util.appendUrl=S;const x=window.fetch;var C=v.CORS=v.CORS||window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,O=v.DefaultTimeout=v.DefaultTimeout||6e4,I=v.FetchRequest={commit:function(t,e,i,n){switch(t=t?t.toUpperCase():t){case"GET":return this.get(e,i,n);case"POST":return this.post(e,i,n);case"PUT":return this.put(e,i,n);case"DELETE":return this.delete(e,i,n);default:return this.get(e,i,n)}},get:function(t,e,i){i=i||{};return t=this.prefixUrl(t,i),t=S(t,this.getParamString(e||{})),this.urlIsLong(t)?this.postSimulate("GET",t.substring(0,t.indexOf("?")-1),e,i):this.fetchByES(t,e,i,"GET")},delete:function(t,e,i){i=i||{};return t=this.prefixUrl(t,i),t=S(t,this.getParamString(e||{})),!this.urlIsLong(t)&&C?this.fetchByES(t,e,i,"DELETE"):this.postSimulate("DELETE",t.substring(0,t.indexOf("?")-1),e,i)},post:function(t,e,i){return i=i||{},this.fetchByES(this.prefixUrl(t,i),e,i,"POST")},put:function(t,e,i){return i=i||{},this.fetchByES(this.prefixUrl(t,i),e,i,"PUT")},urlIsLong:function(t){for(var e=0,i=null,n=0,s=t.length;n<s;n++)(i=t.charCodeAt(n))<127?e++:128<=i&&i<=2047?e+=2:2048<=i&&i<=65535&&(e+=3);return!(e<2e3)},postSimulate:function(t,e,i,n){return e+=(e.indexOf("?")>-1?"&":"?")+"_method="+t,"string"!=typeof i&&(i=JSON.stringify(i)),this.post(e,i,n)},prefixUrl:function(t,e){return e&&e.proxy&&("function"==typeof e.proxy?t=e.proxy(t):(t=decodeURIComponent(t),t=e.proxy+encodeURIComponent(t))),t},fetchByES:function(t,e,i,n){return(i=i||{}).headers=i.headers||{},i.headers["Content-Type"]||(i.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8"),i.timeout?this.timeDelay(i.timeout,x(t,{method:n,headers:i.headers,body:"PUT"===n||"POST"===n?e:void 0,credentials:i.withCredentials?"include":"omit",mode:"cors",timeout:O}).then(function(t){return t})):x(t,{method:n,body:"PUT"===n||"POST"===n?e:void 0,headers:i.headers,credentials:i.withCredentials?"include":"omit",mode:"cors",timeout:O}).then(function(t){return t})},fetchByJsonp:function(t,e){return e=e||{},T()(t,{method:"GET",timeout:e.timeout}).then(function(t){return t})},timeDelay:function(t,e){return new Promise(function(i,n){setTimeout(function(){n(new Error("timeout"))},t),e.then(i,n)})},getParamString:function(t){var e=[];for(var i in t){var n=t[i];if(null!=n&&"function"!=typeof n){var s;if("object"==typeof n&&n.constructor===Array){for(var o,r=[],a=0,c=n.length;a<c;a++)o=n[a],r.push(encodeURIComponent(null===o||void 0===o?"":o));s="["+r.join(",")+"]"}else s=encodeURIComponent(n);e.push(encodeURIComponent(i)+"="+s)}}return e.join("&")}};v.Network.FetchRequest=I,v.Network.CORS=C,v.Network.DefaultTimeout=O,v.Service=v.Service||{};class L{constructor(t,e,i,n,s,o,r){this.method=t,this.url=e,this.params=i,this.fetchServiceData(n,s,o,r)}fetchServiceData(t,e,i,n){I.commit(this.method,this.url,this.params,{}).then(function(t){return t.text?t.text():t.json()}).then(function(s){var o=null;"string"!=typeof s||"true"!=s.toLowerCase()&&"false"!=s.toLowerCase()?"string"==typeof s&&(o=s):(o={},"true"==s.toLowerCase()?o.succeed=!0:o.error=!0),o&&!o.error||(o=o&&o.error?{error:o.error}:{error:!0}),o.error?n(o):(isNaN(o)||(o={value:o}),"string"==typeof o&&(o={value:o}),"[object Array]"!=Object.prototype.toString.call(o)?o.succeed=void 0==o.succeed||o.succeed:o={value:o,succeed:!0},i(o,t,e))})}}v.Service.IServiceQuery=L;v.GeoSpark.TimeSpaceCubeService=void 0;class R{constructor(t,e,i){this.urlAddress="",this.queryOption={},this.handleSuccess=e,this.handleFailure=i,this.prefixUrlPost(t.ip,t.socket,t.queryOption),new L("GET",this.urlAddress,this.queryOption,this.map,this.handleSuccess,this.handleFailure)}prefixUrlPost(t,e,i){this.urlAddress="http://192.168.81.223:9091/pgsql/tableInfoAsJson?libName=postgis&tableName=createspacetimecube_zhc_001&schemas=public&includeProps=true",this.urlAddress=""+y+t+w+e+"/"+g,this.queryOption=i}}v.GeoSpark.TimeSpaceCubeService=R,n.GeoSpark.TimeSpaceCubeLayer=void 0;class P{constructor(t,e,i){this.layer=null,this.styleOptions=t.styleOption,this.successCallback=e,this.failureCallback=i,new R(t,this.onLoadSuccess,this.onLoadFailure)}onLoadSuccess(t,e,i){var n=[],s=t.features;null!=s&&void 0!=s&&(s.forEach(function(t){var s=t.properties.cubeindex,o=JSON.parse(s),a=(o.maxX+o.minX)/2,c=(o.maxY+o.minY)/2,h=new r.a.Entity({name:o.location[0]+"-"+o.location[1]+"-"+o.location[2],position:r.a.Cartesian3.fromDegrees(a,c,i.height),box:{dimensions:new r.a.Cartesian3(i.x,i.y,i.z),material:r.a.Color.RED.withAlpha(.5),outline:!0,outlineColor:r.a.Color.BLACK}});e.entities.add(h),n.push(h)}),this.successCallback(n))}onLoadFailure(){}}P.successCallback=void 0,P.failureCallback=void 0;n.GeoSpark.TimeSpaceCubeLayer=function(t,e,i,n,s){return new P(t,e,i,n,s)};const D="http://",B=":",A=":",k=",",M=";",U="polygon",F="stGeoHashQueryByAgg",j="0";v.ElasticSearch=v.ElasticSearch||{};class q{constructor(t,e,i,n,s,o,r,a){this.method=t,this.url=e,this.params=i,this.fetchServiceData(s,n,o,r,a)}fetchServiceData(t,e,i,n,s){I.commit(this.method,this.url,this.params,{}).then(function(t){return t.json()}).then(function(n){i(n,t,e,s)})}}v.ElasticSearch.IServiceLoadData=q,n.ElasticSearch.GeoHashLayer=void 0;class G{constructor(t,e,i,n,s,o){this.layer=null,this.map=i,this.urlAddress="",this.queryOption={},this.styleOption=s,this.onCallback=o,this.prefixUrlPost(t,e,n),new q("GET",this.urlAddress,this.queryOption,this.styleOption,this.map,this.onSuccess,this.onFailure,this.onCallback)}prefixUrlPost(t,e,i){this.urlAddress=""+D+t+B+e+"/es/"+F,this.queryOption.indexName=i.db,this.queryOption.typeName=i.table,i&&i.space&&(this.queryOption.aggfield=i.space.field,this.queryOption.spatialCondition=U+A+i.space.north+k+i.space.west+M+i.space.north+k+i.space.east+M+i.space.south+k+i.space.east+M+i.space.south+k+i.space.west),i&&i.time&&(this.queryOption.timefield=i.time.field,this.queryOption.timeCondition=""+i.time.starttime+k+i.time.endtime,this.startTime=i.time.starttime,this.endTime=i.time.endtime),this.queryOption.aggGeoFormat=j,this.queryOption.percision=i.space.percision}onSuccess(t,e,i,o){var r=[],a=t.features;null!=a&&void 0!=a&&(a.forEach(function(t){r.push({geometry:{type:"Point",coordinates:t.geometry.coordinates},count:t.properties.aggcount})}),r=new s.DataSet(r),void 0==n.ElasticSearch.GeoHashLayer?n.ElasticSearch.GeoHashLayer=new u(e,r,i):n.ElasticSearch.GeoHashLayer.updateData(r,i),null!=o&&void 0!=o&&o(t))}onFailure(){}}n.ElasticSearch.GeoHashService=function(t,e,i,n,s,o){return new G(t,e,i,n,s,o)},i.d(e,"CesiumZondy",function(){return n}),i.d(e,"MapvLayer",function(){return u}),i.d(e,"EchartsLayer",function(){return m}),i.d(e,"MapvBaseLayer",function(){return c}),i.d(e,"MapCoordSys",function(){return d}),i.d(e,"TimeSpaceCubeLayer",function(){return P}),i.d(e,"GeoHashService",function(){return G})},function(t,e){!function(e){"use strict";if(e.__disableNativeFetch||!e.fetch){a.prototype.append=function(t,e){t=o(t),e=r(e);var i=this.map[t];i||(i=[],this.map[t]=i),i.push(e)},a.prototype.delete=function(t){delete this.map[o(t)]},a.prototype.get=function(t){var e=this.map[o(t)];return e?e[0]:null},a.prototype.getAll=function(t){return this.map[o(t)]||[]},a.prototype.has=function(t){return this.map.hasOwnProperty(o(t))},a.prototype.set=function(t,e){this.map[o(t)]=[r(e)]},a.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach(function(i){this.map[i].forEach(function(n){t.call(e,n,i,this)},this)},this)};var i={blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e},n=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];p.prototype.clone=function(){return new p(this)},l.call(p.prototype),l.call(f.prototype),f.prototype.clone=function(){return new f(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new a(this.headers),url:this.url})},f.error=function(){var t=new f(null,{status:0,statusText:""});return t.type="error",t};var s=[301,302,303,307,308];f.redirect=function(t,e){if(-1===s.indexOf(e))throw new RangeError("Invalid status code");return new f(null,{status:e,headers:{location:t}})},e.Headers=a,e.Request=p,e.Response=f,e.fetch=function(t,e){return new Promise(function(n,s){var o;o=p.prototype.isPrototypeOf(t)&&!e?t:new p(t,e);var r=new XMLHttpRequest;var c=!1;function h(){if(4===r.readyState){var t=1223===r.status?204:r.status;if(t<100||t>599){if(c)return;return c=!0,void s(new TypeError("Network request failed"))}var e={status:t,statusText:r.statusText,headers:function(t){var e=new a;return t.getAllResponseHeaders().trim().split("\n").forEach(function(t){var i=t.trim().split(":"),n=i.shift().trim(),s=i.join(":").trim();e.append(n,s)}),e}(r),url:"responseURL"in r?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):void 0},i="response"in r?r.response:r.responseText;c||(c=!0,n(new f(i,e)))}}r.onreadystatechange=h,r.onload=h,r.onerror=function(){c||(c=!0,s(new TypeError("Network request failed")))},r.open(o.method,o.url,!0);try{"include"===o.credentials&&("withCredentials"in r?r.withCredentials=!0:console&&console.warn&&console.warn("withCredentials is not supported, you can ignore this warning"))}catch(t){console&&console.warn&&console.warn("set withCredentials error:"+t)}"responseType"in r&&i.blob&&(r.responseType="blob"),o.headers.forEach(function(t,e){r.setRequestHeader(e,t)}),r.send(void 0===o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0,void 0!==t&&t.exports&&(t.exports=e.fetch)}function o(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function r(t){return"string"!=typeof t&&(t=String(t)),t}function a(t){this.map={},t instanceof a?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function c(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function h(t){return new Promise(function(e,i){t.onload=function(){e(t.result)},t.onerror=function(){i(t.error)}})}function u(t){var e=new FileReader;return e.readAsArrayBuffer(t),h(e)}function l(){return this.bodyUsed=!1,this._initBody=function(t,e){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(i.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t,this._options=e;else if(i.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(t){if(!i.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t))throw new Error("unsupported BodyInit type")}else this._bodyText=""},i.blob?(this.blob=function(){var t=c(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(u)},this.text=function(){var t,e,i,n,s,o,r,a=c(this);if(a)return a;if(this._bodyBlob)return t=this._bodyBlob,e=this._options,i=new FileReader,n=e.headers.map["content-type"]?e.headers.map["content-type"].toString():"",s=/charset\=[0-9a-zA-Z\-\_]*;?/,o=t.type.match(s)||n.match(s),r=[t],o&&r.push(o[0].replace(/^charset\=/,"").replace(/;$/,"")),i.readAsText.apply(i,r),h(i);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=c(this);return t||Promise.resolve(this._bodyText)},i.formData&&(this.formData=function(){return this.text().then(d)}),this.json=function(){return this.text().then(JSON.parse)},this}function p(t,e){var i,s,o=(e=e||{}).body;if(p.prototype.isPrototypeOf(t)){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new a(t.headers)),this.method=t.method,this.mode=t.mode,o||(o=t._bodyInit,t.bodyUsed=!0)}else this.url=t;if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new a(e.headers)),this.method=(i=e.method||this.method||"GET",s=i.toUpperCase(),n.indexOf(s)>-1?s:i),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o,e)}function d(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var i=t.split("="),n=i.shift().replace(/\+/g," "),s=i.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(s))}}),e}function f(t,e){e||(e={}),this._initBody(t,e),this.type="default",this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof a?e.headers:new a(e.headers),this.url=e.url||""}}("undefined"!=typeof self?self:this)},function(t,e){var i,n,s=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function a(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(t){i=o}try{n="function"==typeof clearTimeout?clearTimeout:r}catch(t){n=r}}();var c,h=[],u=!1,l=-1;function p(){u&&c&&(u=!1,c.length?h=c.concat(h):l=-1,h.length&&d())}function d(){if(!u){var t=a(p);u=!0;for(var e=h.length;e;){for(c=h,h=[];++l<e;)c&&c[l].run();l=-1,e=h.length}c=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===r||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];h.push(new f(t,e)),1!==h.length||u||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(t){return[]},s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e,i){(function(t,e){!function(t,i){"use strict";if(!t.setImmediate){var n,s,o,r,a,c=1,h={},u=!1,l=t.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(t);p=p&&p.setTimeout?p:t,"[object process]"==={}.toString.call(t.process)?n=function(t){e.nextTick(function(){f(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){f(t.data)},n=function(t){o.port2.postMessage(t)}):l&&"onreadystatechange"in l.createElement("script")?(s=l.documentElement,n=function(t){var e=l.createElement("script");e.onreadystatechange=function(){f(t),e.onreadystatechange=null,s.removeChild(e),e=null},s.appendChild(e)}):n=function(t){setTimeout(f,0,t)}:(r="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(r)&&f(+e.data.slice(r.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),n=function(e){t.postMessage(r+e,"*")}),p.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var s={callback:t,args:e};return h[c]=s,n(c),c++},p.clearImmediate=d}function d(t){delete h[t]}function f(t){if(u)setTimeout(f,0,t);else{var e=h[t];if(e){u=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(i,n)}}(e)}finally{d(t),u=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,i(3),i(8))},function(t,e,i){(function(t){var n=void 0!==t&&t||"undefined"!=typeof self&&self||window,s=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(s.call(setTimeout,n,arguments),clearTimeout)},e.setInterval=function(){return new o(s.call(setInterval,n,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(n,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},i(9),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,i(3))}]);