!function(n){var a={};function i(t){if(a[t])return a[t].exports;var e=a[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=n,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=8)}([function(t,e){t.exports=ol},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MapvRenderer=void 0;var a,i=function(){function a(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}}(),o=function t(e,n,a){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,a)}if("value"in i)return i.value;var r=i.get;return void 0!==r?r.call(a):void 0},r=n(0),s=(a=r)&&a.__esModule?a:{default:a},u=n(4),h=n(3);var l=h.baiduMapLayer?h.baiduMapLayer.__proto__:Function;e.MapvRenderer=function(t){function c(t,e,n,a,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,t,e,n));r.dataSet=e,r.mapWidth=a,r.mapHeight=i;var s=r;return n=n||{},r.source=o,s.animator=null,s.map=t,s.init(n),s.argCheck(n),r.canvasLayer=new u.MapvCanvasLayer({map:t,context:r.context,paneName:n.paneName,mixBlendMode:n.mixBlendMode,enableMassClear:n.enableMassClear,zIndex:n.zIndex,width:a,height:i,update:function(){s._canvasUpdate()}}),r.clickEvent=r.clickEvent.bind(r),r.mousemoveEvent=r.mousemoveEvent.bind(r),t.on("movestart",r.moveStartEvent.bind(r)),t.on("moveend",r.moveEndEvent.bind(r)),t.getView().on("change:center",r.zoomEvent.bind(r)),t.on("pointerdrag",r.dragEvent.bind(r)),r.bindEvent(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(c,l),i(c,[{key:"init",value:function(t){var e=this;e.options=t,this.initDataRange(t),this.context=e.options.context||"2d",e.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(e.options.zIndex),this.initAnimator()}},{key:"clickEvent",value:function(t){var e=t.pixel;o(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"clickEvent",this).call(this,{x:e[0]+this.offset[0],y:e[1]+this.offset[1]},t)}},{key:"mousemoveEvent",value:function(t){var e=t.pixel;o(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"mousemoveEvent",this).call(this,{x:e[0],y:e[1]},t)}},{key:"dragEvent",value:function(){this.clear(this.getContext())}},{key:"zoomEvent",value:function(){this.clear(this.getContext())}},{key:"moveStartEvent",value:function(){var t=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=t.stepsRange.start)}},{key:"moveEndEvent",value:function(){this.canvasLayer.draw()}},{key:"bindEvent",value:function(){var e=this,t=e.map;e.options.methods&&(e.options.methods.click&&t.on("click",e.clickEvent),e.options.methods.mousemove&&(e.pointerInteraction=new s.default.interaction.Pointer,e.pointerInteraction.handleMoveEvent_=function(t){e.mousemoveEvent(t)},t.addInteraction(e.pointerInteraction)))}},{key:"unbindEvent",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.un("click",this.clickEvent),this.options.methods.mousemove&&t.removeInteraction(this.pointerInteraction))}},{key:"addData",value:function(t,e){var n=t;t&&t.get&&(n=t.get()),this.dataSet.add(n),this.update({options:e})}},{key:"update",value:function(t){var e=t||{},n=e.data;n&&n.get&&(n=n.get()),null!=n&&this.dataSet.set(n),o(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"update",this).call(this,{options:e.options})}},{key:"draw",value:function(){this.canvasLayer.draw()}},{key:"getData",value:function(){return this.dataSet}},{key:"removeData",value:function(e){if(this.dataSet){var t=this.dataSet.get({filter:function(t){return null==e||"function"!=typeof e||!e(t)}});this.dataSet.set(t),this.update({options:null})}}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"_canvasUpdate",value:function(n){if(this.canvasLayer){var y=this,a=y.options.animation,m=y.map,t=y.canvasLayer.canvas.getContext(y.context);if(y.isEnabledTime()){if(void 0===n)return void y.clear(t);"2d"==y.context&&(t.save(),t.globalCompositeOperation="destination-out",t.fillStyle="rgba(0, 0, 0, .1)",t.fillRect(0,0,t.canvas.width,t.canvas.height),t.restore())}else this.clear(t);if("2d"==y.context)for(var e in y.options)t[e]=y.options[e];else t.clear(t.COLOR_BUFFER_BIT);m.getView();var i=[100,100],o=(y.map.ol_uid,document.querySelector(".ol-viewport"));if(o){var r=getComputedStyle(o);i[0]=parseInt(r.width,10),i[1]=parseInt(r.height,10)}var s=m.getView().calculateExtent(i),c=m.getPixelFromCoordinate([s[0],s[3]]),u={transferCoordinate:function(t){var e,n,a,i,o,r,s,c,u,l,p=m.getPixelFromCoordinate(t),h=-m.getView().getRotation(),d=m.getPixelFromCoordinate(m.getView().getCenter()),v=(e=p,n=d,a=y.pixelRatio,i=(e[0]-n[0])*a+n[0],o=(e[1]-n[1])*a+n[1],[i,o]),f=(r=v,s=h,c=d,u=Math.cos(s)*(r[0]-c[0])-Math.sin(s)*(r[1]-c[1])+c[0],l=Math.sin(s)*(r[0]-c[0])+Math.cos(s)*(r[1]-c[1])+c[1],[u,l]);return[f[0]+y.offset[0],f[1]+y.offset[1]]}};void 0!==n&&(u.filter=function(t){var e=a.trails||10;return n&&t.time>n-e&&t.time<n}),y.isEnabledTime()&&!y.notFirst&&(y.canvasLayer.resize(y.mapWidth,y.mapHeight),y.notFirst=!0);var l=y.dataSet.get(u);y.processData(l),y.options._size=y.options.size;var p=m.getPixelFromCoordinate([0,0]);p=[p[0]-c[0],p[1]-c[1]],this.drawContext(t,new h.DataSet(l),y.options,{x:p[0],y:p[1]}),y.isEnabledTime()&&this.source.changed(),y.options.updateCallback&&y.options.updateCallback(n)}}},{key:"isEnabledTime",value:function(){var t=this.options.animation;return t&&!(!1===t.enabled)}},{key:"argCheck",value:function(t){"heatmap"===t.draw&&t.strokeStyle&&console.warn("[heatmap] options.strokeStyle is discard, pleause use options.strength [eg: options.strength = 0.1]")}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"clear",value:function(t){t&&t.clearRect&&t.clearRect(0,0,t.canvas.width,t.canvas.height)}}]),c}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(1);Object.defineProperty(e,"MapvRenderer",{enumerable:!0,get:function(){return a.MapvRenderer}})},function(t,e){t.exports=function(){try{return mapv}catch(t){return{}}}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function a(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}}();e.MapvCanvasLayer=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t||{},this.enableMassClear=this.options.enableMassClear,this._map=t.map,this.paneName=this.options.paneName||"mapPane",this.context=this.options.context||"2d",this.zIndex=this.options.zIndex||2,this.mixBlendMode=this.options.mixBlendMode||null,this.width=t.width,this.height=t.height,this.initialize()}return a(e,[{key:"initialize",value:function(){var t=this,e=t.canvas=document.createElement("canvas");e.style.cssText="position:absolute;left:0;top:0;z-index:"+t.zIndex+";user-select:none;",e.style.mixBlendMode=t.mixBlendMode,e.className="mapvClass";var n="undefined"==typeof window?{}:window,a=t.devicePixelRatio=n.devicePixelRatio;e.width=t.width,e.height=t.height,"2d"==t.context&&e.getContext(t.context).scale(a,a),e.style.width=e.width+"px",e.style.height=e.height+"px"}},{key:"draw",value:function(){this.options.update&&this.options.update.call(this)}},{key:"resize",value:function(t,e){this.canvas.width=t,this.canvas.height=e,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"}},{key:"getContainer",value:function(){return this.canvas}},{key:"setZIndex",value:function(t){this.canvas.style.zIndex=t}},{key:"getZIndex",value:function(){return this.zIndex}}]),e}()},function(t,e,n){"use strict";var a,i=n(0),o=(a=i)&&a.__esModule?a:{default:a};o.default.zondy=o.default.zondy||{},o.default.zondy.control=o.default.zondy.control||{}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MapvSource=void 0;var a,o=function(){function a(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}}(),i=n(0),r=(a=i)&&a.__esModule?a:{default:a};n(5);var p=n(1);var s=e.MapvSource=function(t){function i(t,e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,{attributions:n.attributions||new r.default.Attribution({html:"© 2017 百度 MapV提供数据<span>© <a href='http://www.smaryun.com' target='_blank'>MapGIS WebClient</a></span>"}),canvasFunction:function(t,e,n,a,i){var o=a[0]*n,r=a[1]*n,s=this.map.getSize()[0]*n,c=this.map.getSize()[1]*n;this.layer||(this.layer=new p.MapvRenderer(this.map,this.dataSet,this.mapvOptions,o,r,this));this.layer.pixelRatio=n,this.layer.offset=[(o-s)/2/n,(r-c)/2/n],this.rotate?this.rotate!==this.map.getView().getRotation()&&(this.layer.canvasLayer.resize(o,r),this.rotate=this.map.getView().getRotation()):this.rotate=this.map.getView().getRotation();var u=this.layer.canvasLayer.canvas;this.layer.isEnabledTime()||(this.layer.canvasLayer.resize(o,r),this.layer.canvasLayer.draw());if(!this.context){var u=document.createElement("CANVAS");o&&(u.width=o),r&&(u.height=r),this.context=u.getContext("2d")}var l=this.context.canvas;this.context.clearRect(0,0,l.width,l.height),l.width=o,l.height=r,l.style.width=o+"px",l.style.height=r+"px",this.context.drawImage(u,0,0,o,r,0,0,o,r),(this.resolution!==e||JSON.stringify(this.extent)!==JSON.stringify(t))&&(this.resolution=e,this.extent=t);return this.context.canvas},logo:n.logo,projection:n.projection,ratio:n.ratio,resolutions:n.resolutions,state:n.state}));return a.map=t,a.dataSet=e,a.mapvOptions=n,a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,r.default.source.ImageCanvas),o(i,[{key:"addData",value:function(t,e){this.layer.addData(t,e)}},{key:"getData",value:function(){return this.layer&&(this.dataSet=this.layer.getData()),this.dataSet}},{key:"removeData",value:function(t){this.layer&&this.layer.removeData(t)}},{key:"clearData",value:function(){this.layer.clearData()}},{key:"update",value:function(t){this.layer.update(t),this.changed()}}]),i}();r.default.zondy.MapvSource=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(6);Object.defineProperty(e,"MapvSource",{enumerable:!0,get:function(){return a.MapvSource}});var i=n(2);Object.keys(i).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return i[t]}})})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(7);Object.keys(a).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return a[t]}})})}]);